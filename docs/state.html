<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Metal.js</title><meta name="theme-color" content="#9552ef"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/vendor/codemirror/lib/codemirror.css"><link rel="stylesheet" href="/vendor/codemirror/theme/material.css"><script src="/vendor/codemirror/lib/codemirror.js"></script><script src="/vendor/codemirror/mode/soy/soy.js"></script><script src="/vendor/codemirror/mode/javascript/javascript.js"></script><script src="http://use.typekit.net/qed5qir.js"></script><script>try{Typekit.load();}catch(e){}</script></head><body><header class="header"><div class="container"><div class="header-bg"></div><nav class="topbar"><a class="topbar-logo" href="/"><img class="topbar-logo-image" src="/images/logo_signature@2x.png" alt="Metal.js Logo" width="35" height="28"><h1 class="topbar-logo-text">Metal.js</h1></a><ul class="topbar-menu"><li class="topbar-menu-item"><a class="topbar-menu-link" href="/docs/">Documentation</a></li><li class="topbar-menu-item"><a class="rounded-icon topbar-icon-github" target="_blank" href="https://github.com/metal/metal"><img src="/images/github_icon.svg" alt="GitHub Icon" width="16"></a></li></ul></nav></div></header><main class="docs"><div class="container"><div class="row"><nav class="docs-nav col-md-3"><p class="docs-nav-group">Quick Start</p><ul class="docs-nav-list"><li class="docs-nav-item"><a href="/docs/" class="docs-nav-link">Getting Started</a></li><li class="docs-nav-item"><a href="/docs/modal.html" class="docs-nav-link">Tutorial: Modal</a></li><li class="docs-nav-item"><a href="/docs/modal_events.html" class="docs-nav-link">Tutorial: Modal - Events</a></li><li class="docs-nav-item"><a href="/docs/modal_updates.html" class="docs-nav-link">Tutorial: Modal - Updates</a></li><li class="docs-nav-item"><a href="/docs/modal_nested.html" class="docs-nav-link">Tutorial: Modal - Nested Components</a></li><li class="docs-nav-item"><a href="/docs/modal_testing.html" class="docs-nav-link">Tutorial: Modal - Testing</a></li></ul><p class="docs-nav-group">Guides</p><ul class="docs-nav-list"><li class="docs-nav-item"><a href="/docs/alias.html" class="docs-nav-link">Alias</a></li><li class="docs-nav-item"><a href="/docs/state.html" class="docs-nav-link">State</a></li><li class="docs-nav-item"><a href="/docs/component-lifecycle.html" class="docs-nav-link">Component Lifecycle</a></li><li class="docs-nav-item"><a href="/docs/rendering-components.html" class="docs-nav-link">Rendering Components</a></li><li class="docs-nav-item"><a href="/docs/inline-events.html" class="docs-nav-link">Inline Events</a></li><li class="docs-nav-item"><a href="/docs/nested-components.html" class="docs-nav-link">Nested Components</a></li><li class="docs-nav-item"><a href="/docs/importing.html" class="docs-nav-link">Importing</a></li><li class="docs-nav-item"><a href="/docs/soy-components.html" class="docs-nav-link">Soy Components</a></li><li class="docs-nav-item"><a href="/docs/jsx-components.html" class="docs-nav-link">JSX Components</a></li><li class="docs-nav-item"><a href="/docs/progressive-enhancement.html" class="docs-nav-link">Progressive Enhancement</a></li><li class="docs-nav-item"><a href="/docs/yeoman-generator.html" class="docs-nav-link">Yeoman Generator</a></li><li class="docs-nav-item"><a href="/docs/building.html" class="docs-nav-link">Building</a></li><li class="docs-nav-item"><a href="/docs/performance.html" class="docs-nav-link">Performance</a></li></ul></nav><article class="docs-content col-md-6 col-md-offset-1"><h1>State</h1><p>The <strong>State</strong> class provides a way of defining state properties for the classes that extend it, as well as watching these properties for value changes.</p><p>The <strong>Component</strong> class already extends from <strong>State</strong> by default, besides automatically rerendering when there is a change.</p><p>If your class doesn't need to render anything it's best to extend from <strong>State</strong> directly though. That way you'll have access to its features without also inheriting logic you won't need.</p><h2>Configuring state</h2><p>The following example is a class that extends directly from <strong>State</strong> and defines a state property named <code>number</code> on itself:</p><textarea class="code" data-mode="javascript">
import core from 'metal';
import State from 'metal-state';

class Calculator extends State {
  /**
   * Coverts string numbers to the number type.
   */
  setNumber(val) {
    if (core.isString(val)) {
      val = parseInt(val, 10);
    }
    return val;
  }
}

Calculator.STATE = {
  number: {
    // Called whenever a new value is set. Useful when normalizing your
    // state data.
    setter: 'setNumber',

    // Accepts either number or string types. If the validator check fails,
    // the new value is discarded, and the current value kept.
    validator: val => core.isNumber(val) || core.isString(val),

    // Initial value
    value: 0
  }
}</textarea><p>If you're familiar with <a href="http://yuilibrary.com/">YUI</a>, you may recognize this feature and notice that it's very similar to how attributes are defined there. You basically just need to list all attributes you'll be using on the <strong>STATE</strong> static variable (on YUI it would be on <strong>ATTRS</strong>), and provide their configuration options, like initial value and validator. For a list of all valid options, take a look at <strong>State</strong>'s <a href="http://github.com/metal/metal-state/blob/c87ac15b8a9fa3ee64c421f22411f97cd376024a/src/State.js#L61">docs</a>.</p><h2>Accessing and updating state</h2><p>The constructor can receive a configuration object with initial values to use for its state properties. You can access or change an object's state in the same way you'd access or change any object property. Or you can also call the <code>setState</code> function, which updates the properties specified by the given object.</p><textarea class="code" data-mode="javascript">var obj = new Calculator();
console.log(obj.number); // Prints 0

obj.number = '1';
console.log(obj.number); // Prints 1

obj.setState({number: 2});
console.log(obj.number); // Prints 2</textarea><p>You can also track state value changes by listening to the appropriate event.</p><textarea class="code" data-mode="javascript">obj.on('numberChanged', function(event) &lbrace;
// event.prevVal has the previous value.
// event.newVal has the new value.
&rbrace;);</textarea><p>To see all features of the <strong>State</strong> class take a look at its <a href="https://github.com/metal/metal-state/blob/master/test/State.js">unit tests</a>.</p><h2 id="config">Configuration data</h2><p>Any data passed to the constructor that has not been configured as a state property can still be accessed via <code>config</code>. Changes to these properties won't be tracked, so it's usually intended for your component's options, which are only set from the outside.</p><textarea class="code" data-mode="javascript">var obj = new Calculator({
  number: 10,
  foo: 'foo'
});
console.log(obj.number); // Prints 2
console.log(obj.foo); // Prints undefined
console.log(obj.config.foo); // Prints 'foo'</textarea></article></div></div></main><footer class="footer"><div class="container"><p class="footer-paragraph"><span class="footer-credits"><a class="rounded-icon footer-icon-liferay" target="_blank" href="http://liferay.com/"><img src="/images/liferay_logo.svg" alt="Liferay Icon" width="19" height="19"></a>Brought to you by <a class="footer-link" target="_blank" href="http://liferay.com/">Liferay, Inc</a>.</span><span class="footer-license"><a class="footer-link" target="_blank" href="https://github.com/metal/metal/blob/master/LICENSE.md">BSD</a> License.</span></p></div></footer><script src="/scripts/highlight.js"></script></body></html>