<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Metal.js</title><meta name="theme-color" content="#9552ef"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/vendor/codemirror/lib/codemirror.css"><link rel="stylesheet" href="/vendor/codemirror/theme/material.css"><script src="/vendor/codemirror/lib/codemirror.js"></script><script src="/vendor/codemirror/mode/soy/soy.js"></script><script src="/vendor/codemirror/mode/javascript/javascript.js"></script><script src="http://use.typekit.net/qed5qir.js"></script><script>try{Typekit.load();}catch(e){}</script></head><body><header class="header"><div class="container"><div class="header-bg"></div><nav class="topbar"><a class="topbar-logo" href="/"><img class="topbar-logo-image" src="/images/logo_signature@2x.png" alt="Metal.js Logo" width="35" height="28"><h1 class="topbar-logo-text">Metal.js</h1></a><ul class="topbar-menu"><li class="topbar-menu-item"><a class="topbar-menu-link" href="/docs/">Documentation</a></li><li class="topbar-menu-item"><a class="rounded-icon topbar-icon-external" target="_blank" href="https://github.com/metal/metal"><img src="/images/github_icon.svg" alt="GitHub Icon" width="16"></a></li><li class="topbar-menu-item"><a class="rounded-icon topbar-icon-external" target="_blank" href="http://metaljs-chat.wedeploy.io/"><img src="/images/slack_icon.svg" alt="Slack Icon"></a></li></ul></nav></div></header><main class="docs"><div class="container"><div class="row"><nav class="docs-nav col-md-3"><p class="docs-nav-group">Quick Start</p><ul class="docs-nav-list"><li class="docs-nav-item"><a href="/docs/" class="docs-nav-link">Getting Started</a></li><li class="docs-nav-item"><a href="/docs/modal.html" class="docs-nav-link">Tutorial: Modal</a></li><li class="docs-nav-item"><a href="/docs/modal_events.html" class="docs-nav-link">Tutorial: Modal - Events</a></li><li class="docs-nav-item"><a href="/docs/modal_updates.html" class="docs-nav-link">Tutorial: Modal - Updates</a></li><li class="docs-nav-item"><a href="/docs/modal_nested.html" class="docs-nav-link">Tutorial: Modal - Nested Components</a></li><li class="docs-nav-item"><a href="/docs/modal_testing.html" class="docs-nav-link">Tutorial: Modal - Testing</a></li></ul><p class="docs-nav-group">Guides</p><ul class="docs-nav-list"><li class="docs-nav-item"><a href="/docs/alias.html" class="docs-nav-link">Alias</a></li><li class="docs-nav-item"><a href="/docs/state.html" class="docs-nav-link">State</a></li><li class="docs-nav-item"><a href="/docs/component-lifecycle.html" class="docs-nav-link">Component Lifecycle</a></li><li class="docs-nav-item"><a href="/docs/rendering-components.html" class="docs-nav-link">Rendering Components</a></li><li class="docs-nav-item"><a href="/docs/inline-events.html" class="docs-nav-link">Inline Events</a></li><li class="docs-nav-item"><a href="/docs/nested-components.html" class="docs-nav-link">Nested Components</a></li><li class="docs-nav-item"><a href="/docs/importing.html" class="docs-nav-link">Importing</a></li><li class="docs-nav-item"><a href="/docs/soy-components.html" class="docs-nav-link">Soy Components</a></li><li class="docs-nav-item"><a href="/docs/jsx-components.html" class="docs-nav-link">JSX Components</a></li><li class="docs-nav-item"><a href="/docs/progressive-enhancement.html" class="docs-nav-link">Progressive Enhancement</a></li><li class="docs-nav-item"><a href="/docs/yeoman-generator.html" class="docs-nav-link">Yeoman Generator</a></li><li class="docs-nav-item"><a href="/docs/building.html" class="docs-nav-link">Building</a></li><li class="docs-nav-item"><a href="/docs/performance.html" class="docs-nav-link">Performance</a></li></ul></nav><article class="docs-content col-md-6 col-md-offset-1"><h1>Tutorial: Modal - Updates</h1><p>In the <a href="/docs/modal_events.html">previous section</a> we learned how to add inline listeners, by making the <strong>Modal</strong>'s close button work.</p><p>We first implemented this feature by disposing of the entire <strong>Modal</strong> instance when it was closed. It'd be best to have the modal just hide itself so it could be shown again afterwards though.</p><h2 id="state">State</h2><p>We've seen that it's possible to pass data to components via the constructor. By default this kind of data is read-only for the component though, that is, it can be received from the outside but not changed from the inside.</p><p>When you need to be able to change a component's data, as well as have that change cause its html contents to update, you should indicate that it'll be part of the component's state.</p><p>This can be done by using your component's <code>STATE</code> static variable, where you can also configure state properties, specifying initial values and validators for example.</p><p>So let's add a <code>shown</code> property to our <strong>Modal</strong> state, in <strong>src/Modal.js</strong>:</p><textarea class="code" data-mode="javascript">Modal.STATE = {
	shown: {
		// The default value will be: `true`.
		value: true
	}
};</textarea><p>For more details about configuring state, check out <a href="/docs/state.html">this guide</a>.</p><h2>Updating the template</h2><p>Now we need to update our template to only show the modal when <code>shown</code> is true.</p><div class="code-tabs"><div class="code-tabs-header"><button class="code-tab selected" data-index="0" type="button">Soy: src/Modal.soy</button><button class="code-tab" data-index="1" type="button">JSX: src/Modal.js</button></div><div class="content"><textarea class="code" data-mode="x-soy">/**
 * State properties are passed to the "render" template in the same way as
 * config properties.
 * @param shown
 */
&lbrace;template .render&rbrace;
	&lt;div class="modal {$shown ? 'show': ''}"&gt;
		...
	&lt;/div&gt;
&lbrace;/template&rbrace;</textarea><textarea class="code hidden" data-mode="javascript">/**
 * State properties are accessed directly from `this`.
 */
render() &lbrace;
	var cssClass = 'modal';
	if (this.shown) {
		cssClass += 'show';
	}
	return &lt;div class={cssClass}&gt;
		...
	&lt;/div&gt;;
}</textarea></div></div><h2>Updating the <code>close</code> function</h2><p>Now we can change our <code>close</code> function to just update the state property.</p><textarea class="code" data-mode="javascript">close() {
  this.shown = false;
}</textarea><p>State changes are automatically detected by <code>Metal.js</code>, causing the component to be rerendered. Since <code>Metal.js</code>uses <a href="http://google.github.io/incremental-dom/">incremental dom</a>, rerendering will cause minimal dom updates. In this case, the <code>shown</code> css class will be removed from the modal element.</p><h2>Run the demo</h2><p>Now compile your code with <code>npm run build</code> and open the demo on a browser. Clicking the <strong>x</strong> button will close the modal as before, but inspecting the dom you'll notice that it's just hidden, not removed from the dom.</p><h2>Playing with state data</h2><p>State data makes it very easy to update a component's contents. If you want to quickly see it working you can make some experiments on your browser's javascript console for example.</p><p>First let's hold the <code>Modal</code> instance somewhere so we can access it:</p><textarea class="code" data-mode="javascript">window.modal = new metal.Modal({
	header: 'My Modal',
	body: 'Built using Metal.js'
});</textarea><p>Now run the demo again, go to the browser's console and type: <code>modal.shown = false</code>. You'll notice that the modal will be hidden as expected. If you now type <code>modal.shown = true</code>, it will show up again.</p><p>If you want you can also turn <code>header</code> and <code>body</code> into state properties as well. All you have to do is:</p><ol><li><p>Add them to <code>STATE</code>, like this:</p><textarea class="code" data-mode="javascript">Modal.STATE = {
	body: {
		value: 'Default body'
	},
	header: {
		value: 'Default header'
	},
	shown: {
		value: true
	}
};</textarea></li><li><p>If you're using JSX templates, change the calls to <code>this.config</code> to call directly from <code>this</code> instead, like this:</p><textarea class="code" data-mode="javascript">render() &lbrace;
	var cssClass = 'modal';
	if (this.shown) {
		cssClass += 'show';
	}
	return &lt;div class={cssClass}&gt;
		&lt;div class="modal-dialog"&gt;
			&lt;div class="modal-content"&gt;
				&lt;header class="modal-header"&gt;
					&lt;button onClick={this.close.bind(this)} type="button" class="close"&gt;
						&lt;span&gt;×&lt;/span&gt;
					&lt;/button&gt;
					&lt;h4&gt;{this.header}&lt;/h4&gt;
				&lt;/header&gt;
				&lt;section class="modal-body"&gt;
					{this.body}
				&lt;/section&gt;
				&lt;footer class="modal-footer"&gt;
					&lt;button type="button" class="btn btn-primary"&gt;OK&lt;/button&gt;
				&lt;/footer&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	&lt;/div&gt;;
}</textarea></li></ol><p>Now if you type something like <code>modal.header = 'New Header'</code> on the console, the contents will also be updated automatically.</p><h2>Next steps</h2><p>Our modal is working as expected now. But what if you want to split it into multiple components? How would we use them together? Check it out in the next section.</p><p><strong><a href="/docs/modal_nested.html">↪ Tutorial: Modal - Nested Components</a></strong></p></article></div></div></main><footer class="footer"><div class="container"><p class="footer-paragraph"><span class="footer-credits"><a class="rounded-icon footer-icon-liferay" target="_blank" href="http://liferay.com/"><img src="/images/liferay_logo.svg" alt="Liferay Icon" width="19" height="19"></a>Brought to you by <a class="footer-link" target="_blank" href="http://liferay.com/">Liferay, Inc</a>.</span><span class="footer-license"><a class="footer-link" target="_blank" href="https://github.com/metal/metal/blob/master/LICENSE.md">BSD</a> License.</span></p></div></footer><script src="/scripts/highlight.js"></script><script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-37033501-7', 'auto');
	ga('send', 'pageview');</script></body></html>